<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Outer Constructor · StructuralEquationModels.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon_zeta.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="StructuralEquationModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">StructuralEquationModels.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">StructuralEquationModels.jl: a fast and flexible SEM framework</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../first_model/">A first model</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Model specification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../specification/specification/">Model specification</a></li><li><a class="tocitem" href="../../specification/graph_interface/">Graph interface</a></li><li><a class="tocitem" href="../../specification/ram_matrices/">RAMMatrices interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Model construction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../construction/">Model construction</a></li><li class="is-active"><a class="tocitem" href>Outer Constructor</a><ul class="internal"><li><a class="tocitem" href="#Optimize-loss-functions-without-implemented-analytic-gradient"><span>Optimize loss functions without implemented analytic gradient</span></a></li></ul></li><li><a class="tocitem" href="../build_by_parts/">Build by parts</a></li></ul></li><li><a class="tocitem" href="../../fitting/fitting/">Model fitting</a></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Model inspection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inspection/inspection/">Model inspection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Collections</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../collection/collection/">Collections</a></li><li><a class="tocitem" href="../../collection/multigroup/">Multigroup models</a></li></ul></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../../developer/extending/">Extending the package</a></li><li><a class="tocitem" href="../../../developer/loss/">Custom loss functions</a></li><li><a class="tocitem" href="../../../developer/imply/">Custom imply types</a></li><li><a class="tocitem" href="../../../developer/sem/">Custom sem types</a></li></ul></li><li><span class="tocitem">Performance tips</span><ul><li><a class="tocitem" href="../../../performance/symbolic/">Symbolic precomputation</a></li><li><a class="tocitem" href="../../../performance/starting_values/">Starting values</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Model construction</a></li><li class="is-active"><a href>Outer Constructor</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Outer Constructor</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/StructuralEquationModels/StructuralEquationModels.jl/blob/master/docs/src/tutorials/construction/outer_constructor.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Outer-Constructor"><a class="docs-heading-anchor" href="#Outer-Constructor">Outer Constructor</a><a id="Outer-Constructor-1"></a><a class="docs-heading-anchor-permalink" href="#Outer-Constructor" title="Permalink"></a></h1><p>We already have seen the outer constructor in action in <a href="../../first_model/#A-first-model">A first model</a>:</p><pre><code class="language-julia hljs">model = Sem(
    specification = partable,
    data = data
)

# output

Structural Equation Model
- Loss Functions
   SemML
- Fields
   observed:  SemObsCommon
   imply:     RAM
   diff:      SemDiffOptim</code></pre><p>The output of this call tells you exactly what model you just constructed (i.e. what the loss functions, observed, imply and diff parts are).</p><p>As you can see, by default, we use maximum likelihood estimation, the RAM imply type and the <code>Optim.jl</code> optimization backend.  To choose something different, you can provide it as a keyword argument:</p><pre><code class="language-julia hljs">model = Sem(
    specification = partable,
    data = data,
    observed = ...,
    imply = ...,
    loss = ...,
    diff = ...
)</code></pre><p>For example, to construct a model for weighted least squares estimation that uses symbolic precomputation and the NLopt backend, write</p><pre><code class="language-julia hljs">model = Sem(
    specification = partable,
    data = data,
    imply = RAMSymbolic,
    loss = SemWLS,
    diff = SemDiffNLopt
)</code></pre><p>In the section on <a href="../construction/#Model-construction">Model construction</a>, we go over the different options you have for each part of the model. Let&#39;s make another example: to use full information maximum likelihood information (FIML), write</p><pre><code class="language-julia hljs">model = Sem(
    specification = partable,
    data = data,
    loss = SemFIML,
    observed = SemObsMissing
)</code></pre><p>You may also provide addition arguments for specific parts of the model. For example, WLS estimation uses per default</p><p class="math-container">\[W = \frac{1}{2} D^T(S^{-1}\otimes S^{-1})D\]</p><p>as the weight matrix, where D is the so-called duplication matrix and S is the observed covariance matrix. However, you can pass any other weight matrix you want (to achieve UWL, DWLS, ADF estimation, for example) as a keyword argument:</p><pre><code class="language-julia hljs">W = ...

model = Sem(
    specification = partable,
    data = data,
    imply = RAMSymbolic,
    loss = SemWLS
    wls_weight_matrix = W
)
</code></pre><p>To see what additional keyword arguments are supported, you can consult the documentation of the specific part of the model (by either using <code>help(...)</code>, or typing <code>?</code> in the REPL to enter the help mode and then typing the name of the thing you want to know something about):</p><pre><code class="language-julia hljs">help(SemWLS)

# output

OUTPUT MISSING!
</code></pre><h2 id="Optimize-loss-functions-without-implemented-analytic-gradient"><a class="docs-heading-anchor" href="#Optimize-loss-functions-without-implemented-analytic-gradient">Optimize loss functions without implemented analytic gradient</a><a id="Optimize-loss-functions-without-implemented-analytic-gradient-1"></a><a class="docs-heading-anchor-permalink" href="#Optimize-loss-functions-without-implemented-analytic-gradient" title="Permalink"></a></h2><p>For loss functions without analytic gradients, it is possible to use finite difference approximation or forward mode automatic differentiation.  All loss functions provided in the package do have analytic gradients (and some even hessians or approximations thereof), so there is no need do use this feature if you are only working with them. However, if you implement your own loss function, you do not have to provide analytic gradients. In that case, you may construct your model just as before, but swap the <code>Sem</code> constructor for either <code>SemFiniteDiff</code> or <code>SemForwardDiff</code>. For example</p><pre><code class="language-julia hljs">model = SemFiniteDiff(
    specification = partable,
    data = data
)</code></pre><p>constructs a model that will use finite difference approximation if you estimate the parameters via <code>sem_fit(model)</code>. Both <code>SemFiniteDiff</code> and <code>SemForwardDiff</code> have an additional keyword argument, <code>has_gradient = ...</code> that can be set to <code>true</code> to indicate that the model has analytic gradients, and only the hessian should be computed via finite difference approximation / automatic differentiation. For example</p><pre><code class="language-julia hljs">using Optim, LineSearches

model = SemFiniteDiff(
    specification = partable,
    data = data,
    has_gradient = true,
    algorithm = Newton()
)</code></pre><p>will construct a model that, when fitted, will use <a href="https://julianlsolvers.github.io/Optim.jl/stable/#algo/newton/">Newton&#39;s Method</a> from the <code>Optim.jl</code> package with analytic gradients and hessians computed via finite difference approximation.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../construction/">« Model construction</a><a class="docs-footer-nextpage" href="../build_by_parts/">Build by parts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Wednesday 11 May 2022 09:33">Wednesday 11 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
